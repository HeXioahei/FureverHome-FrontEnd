# 宠物论坛后端缺失接口清单

## ✅ 已实现的接口（7个）

以下接口后端已实现，前端可以直接使用：

1. ✅ `GET /api/post/list` - 获取帖子列表
   - Query参数：`page`, `pageSize`

2. ✅ `GET /api/post/{id}` - 获取帖子详情
   - Path参数：`id` (帖子ID)

3. ✅ `POST /api/post` - 创建帖子
   - Body参数：`title`, `content`, `summary`(可选), `images`(可选), `tags`(可选), `category`(可选)

4. ✅ `PUT /api/post/{id}` - 更新帖子
   - Path参数：`id`
   - Body参数：帖子数据

5. ✅ `DELETE /api/post/{id}` - 删除帖子
   - Path参数：`id`

6. ✅ `GET /api/post/mine/list` - 获取我的帖子列表
   - Query参数：`page`, `pageSize`

7. ✅ `GET /api/post/user/{userId}/list` - 获取他人帖子列表
   - Path参数：`userId`
   - Query参数：`page`, `pageSize`

---

## ❌ 缺失的接口（5个）

以下接口前端已调用，但后端未实现，需要补充：

### 1. 搜索帖子接口 ❌

**接口路径：** `GET /api/post/search`

**请求参数（Query）：**
- `keyword`: string (必填) - 搜索关键词
- `page`: number (可选) - 页码，默认1
- `pageSize`: number (可选) - 每页数量，默认10

**响应数据：**
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "title": "帖子标题",
        "content": "帖子内容",
        "authorName": "作者名",
        "authorAvatar": "头像URL",
        "timeAgo": "3小时前",
        "likes": 10,
        "comments": 5,
        "views": 100,
        "images": ["图片URL1", "图片URL2"]
      }
    ],
    "total": 50,
    "page": 1,
    "pageSize": 10,
    "totalPages": 5
  }
}
```

**说明：**
- 搜索范围：帖子标题、内容、作者名称
- 需要支持模糊匹配
- 需要支持分页

---

### 2. 获取帖子评论列表接口 ❌

**接口路径：** `GET /api/post/{id}/comments`

**请求参数（Path）：**
- `id`: number - 帖子ID

**请求参数（Query，可选）：**
- `page`: number - 页码
- `pageSize`: number - 每页数量

**响应数据：**
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "content": "评论内容",
      "authorName": "评论者名称",
      "authorAvatar": "头像URL",
      "date": "2025-01-01 12:00:00",
      "timeAgo": "2小时前"
    }
  ]
}
```

**说明：**
- 返回该帖子的所有评论
- 建议按时间倒序排列（最新的在前）
- 时间字段建议同时返回 `date`（绝对时间）和 `timeAgo`（相对时间）

---

### 3. 提交评论接口 ❌

**接口路径：** `POST /api/post/{id}/comments`

**请求参数（Path）：**
- `id`: number - 帖子ID

**请求参数（Body）：**
```json
{
  "content": "评论内容"
}
```

**响应数据：**
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "content": "评论内容",
    "authorName": "当前用户名称",
    "authorAvatar": "当前用户头像URL",
    "date": "2025-01-01 12:00:00",
    "timeAgo": "刚刚"
  }
}
```

**说明：**
- 需要验证用户是否登录
- 需要验证评论内容不能为空
- 返回新创建的评论数据

---

### 4. 点赞/取消点赞接口 ❌

**接口路径：** `POST /api/post/{id}/like`

**请求参数（Path）：**
- `id`: number - 帖子ID

**请求参数（Body）：**
- 无（或可选的空对象 `{}`）

**响应数据：**
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

**说明：**
- 如果用户已点赞该帖子，则取消点赞
- 如果用户未点赞，则点赞
- 需要验证用户是否登录
- 返回空响应即可

---

### 5. 增加浏览数接口 ❌

**接口路径：** `POST /api/post/{id}/view`

**请求参数（Path）：**
- `id`: number - 帖子ID

**请求参数（Body）：**
- 无（或可选的空对象 `{}`）

**响应数据：**
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

**说明：**
- 每次用户打开帖子详情页时调用
- 增加该帖子的浏览数（viewCount）
- 可以设置防刷机制（如：同一用户短时间内多次访问只算一次）
- 返回空响应即可

---

## 📝 接口响应格式统一要求

所有接口应遵循统一的响应格式：

```typescript
{
  code: number;        // 200表示成功，其他表示失败
  message: string;     // 提示信息
  data: T;            // 响应数据，类型根据接口而定
}
```

---

## 🔍 数据字段映射说明

前端使用的字段名与后端可能不一致，需要确认：

| 前端字段 | 后端可能字段 | 说明 |
|---------|------------|------|
| `id` | `id` 或 `postId` | 帖子ID |
| `author` | `authorName` | 作者名称 |
| `avatarInitial` | 从 `authorName` 提取首字符 | 头像首字母 |
| `timeAgo` | `timeAgo` 或 `createTime` | 相对时间 |
| `likes` | `likes` 或 `likeCount` | 点赞数 |
| `comments` | `comments` 或 `commentCount` | 评论数 |
| `views` | `views` 或 `viewCount` | 浏览数 |
| `images` | `images` 或 `mediaUrls` | 图片数组 |

---

## ⚠️ 优先级说明

### 高优先级（必须实现，影响核心功能）

1. **获取帖子评论列表** - `GET /api/post/{id}/comments`
   - 影响：用户无法查看帖子评论
   
2. **提交评论** - `POST /api/post/{id}/comments`
   - 影响：用户无法发表评论

3. **点赞/取消点赞** - `POST /api/post/{id}/like`
   - 影响：用户无法点赞帖子

### 中优先级（建议实现，提升用户体验）

4. **搜索帖子** - `GET /api/post/search`
   - 影响：用户无法搜索帖子（前端已有搜索框）

5. **增加浏览数** - `POST /api/post/{id}/view`
   - 影响：浏览数统计不准确（不影响功能使用）

---

## 📌 注意事项

1. **所有接口需要支持认证（Token）**
   - 需要验证用户登录状态
   - Token通过请求头传递：`Authorization: Bearer {token}`

2. **图片上传**
   - 创建帖子接口 (`POST /api/post`) 如果支持图片上传，需要支持 `multipart/form-data` 格式
   - 图片字段名：`images`（可传多个）

3. **时间字段**
   - 建议同时返回 `date`（绝对时间，如 "2025-01-01 12:00:00"）和 `timeAgo`（相对时间，如 "3小时前"）

4. **分页接口**
   - 需要返回总数 (`total`) 和总页数 (`totalPages`)

5. **搜索接口**
   - 需要支持模糊匹配
   - 搜索范围：帖子标题、内容、作者名称

---

## 🔗 相关文件

- 前端接口定义：`src/api/postApi.ts`
- 前端评论接口：`src/api/commentapi.ts`
- 帖子列表页面：`src/views/forum/PostList.vue`
- 帖子详情页面：`src/views/forum/PostDetail.vue`
- 发布帖子页面：`src/views/forum/PostNew.vue`

