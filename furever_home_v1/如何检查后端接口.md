# 如何检查后端接口是否存在

## 🔍 方法一：使用浏览器开发者工具（推荐）

### 步骤：
1. **打开浏览器开发者工具**
   - 按 `F12` 或右键页面选择"检查"
   - 切换到 **Network（网络）** 标签页

2. **执行操作触发请求**
   - 例如：点击"删除帖子"按钮
   - 在 Network 标签页中会看到所有网络请求

3. **查看请求详情**
   - 点击失败的请求（红色状态码）
   - 查看以下信息：
     - **Request URL（请求URL）**: 确认请求地址是否正确
     - **Request Method（请求方法）**: GET/POST/PUT/DELETE
     - **Status Code（状态码）**: 
       - `200` = 成功
       - `404` = 接口不存在
       - `500` = 服务器内部错误（可能是权限问题或代码错误）
       - `401` = 未登录
       - `403` = 无权限
     - **Response（响应）**: 查看后端返回的错误信息

4. **查看请求头**
   - 检查 `Authorization` 或 `satoken` 头是否存在
   - 确认 Token 是否正确传递

## 🔍 方法二：使用 Apifox 测试接口

### 步骤：
1. **打开 Apifox**
2. **找到对应的接口文档**
   - 例如：`DELETE /api/post/{id}`
3. **设置请求参数**
   - Path参数：`id = 36`
   - Headers：添加 Token（Authorization 或 satoken）
4. **发送请求**
   - 查看响应状态码和响应体
   - 如果返回 500，查看错误信息

## 🔍 方法三：查看后端日志

### 步骤：
1. **查看后端控制台输出**
   - 如果后端在本地运行，查看终端/控制台
   - 查找错误堆栈信息

2. **常见错误类型**：
   - `无此权限：post:delete` = 权限配置问题
   - `NullPointerException` = 空指针异常
   - `SQLException` = 数据库错误

## 🔍 方法四：使用 Postman 或 curl 测试

### 使用 curl 示例：
```bash
# 删除帖子
curl -X DELETE "http://xd6325a9.natappfree.cc/api/post/36" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json"

# 获取帖子详情
curl -X GET "http://xd6325a9.natappfree.cc/api/post/36" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## 📋 当前问题诊断

根据你的错误日志，所有接口都返回 **500 错误**，可能的原因：

### 1. 权限问题（最可能）
- 错误信息：`无此权限：post:delete`
- **解决方法**：
  - 检查后端权限配置
  - 确认当前用户角色是否有相应权限
  - 检查 Token 是否正确传递

### 2. Token 问题
- 所有接口都返回 500，可能是 Token 认证失败
- **检查方法**：
  ```javascript
  // 在浏览器控制台执行
  console.log('Token:', localStorage.getItem('token'))
  console.log('saTokenValue:', localStorage.getItem('saTokenValue'))
  ```

### 3. 后端服务问题
- 后端代码可能有 bug
- **检查方法**：
  - 查看后端日志
  - 确认后端服务是否正常运行
  - 检查数据库连接是否正常

## 🛠️ 调试技巧

### 1. 添加详细日志
在 `request.ts` 中已经添加了详细的错误日志，查看浏览器控制台可以看到：
- 请求URL
- 请求方法
- 响应状态码
- 响应数据

### 2. 检查 Token
```javascript
// 在浏览器控制台执行
const token = localStorage.getItem('token') || localStorage.getItem('saTokenValue')
console.log('当前Token:', token)
```

### 3. 手动测试接口
在浏览器控制台执行：
```javascript
// 测试删除接口
fetch('/api/post/36', {
  method: 'DELETE',
  headers: {
    'Authorization': 'Bearer ' + localStorage.getItem('token'),
    'Content-Type': 'application/json'
  }
})
.then(res => res.json())
.then(data => console.log('响应:', data))
.catch(err => console.error('错误:', err))
```

## 📝 需要检查的接口

根据错误日志，以下接口都返回 500：

1. ✅ `DELETE /api/post/{id}` - 删除帖子
   - 错误：`无此权限：post:delete`
   - **需要检查**：后端权限配置

2. ✅ `GET /api/post/{id}` - 获取帖子详情
   - 错误：`HTTP error! status: 500`
   - **需要检查**：后端代码是否有bug

3. ✅ `GET /api/user/me` - 获取当前用户信息
   - 错误：`HTTP error! status: 500`
   - **需要检查**：用户认证逻辑

4. ✅ `GET /api/post/mine/list` - 获取我的帖子列表
   - 错误：`HTTP error! status: 500`
   - **需要检查**：查询逻辑

5. ✅ `PUT /api/post/{id}` - 更新帖子
   - 响应成功但 `postId` 为 `undefined`
   - **需要检查**：响应数据结构

## 🔧 快速修复建议

1. **检查后端权限配置**
   - 确认用户角色是否有 `post:delete` 权限
   - 检查权限拦截器配置

2. **检查 Token 传递**
   - 确认请求头中正确传递了 Token
   - 检查 Token 格式是否正确

3. **查看后端日志**
   - 找到具体的错误堆栈
   - 根据错误信息修复代码

4. **测试接口**
   - 使用 Apifox 或 Postman 直接测试后端接口
   - 确认接口是否正常工作

